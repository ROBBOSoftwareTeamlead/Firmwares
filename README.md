# Конвертер HEX-файлов прошивки

## Описание

Скрипт `convert_hex.js` предназначен для конвертации HEX-файлов прошивки роботов в формат, используемый в файле `firmwares.js` проекта Robbo Scratch 3.

## Функциональность

Скрипт выполняет следующие операции:
- Читает HEX-файл прошивки
- Фильтрует строки (оставляет только валидные HEX-строки, начинающиеся с `:`)
- Объединяет все строки через точку (`.`), включая контрольную сумму в конце
- Сохраняет результат в текстовый файл

## Использование

### Требования

- Node.js (версия 6.0 или выше)

### Запуск

1. Переместите скрипт `convert_hex.js` в папку с HEX-файлом прошивки
2. Запустите скрипт:

```bash
node convert_hex.js
```

Скрипт автоматически найдет и обработает первый `.hex` файл в текущей директории.

### Результат

Скрипт создаст файл с именем `[имя_исходного_файла]_converted.txt` с конвертированными данными в формате:
```
:100000000C9464000C94720C0C944B0C0C948C00AB.:100010000C948C000C948C000C948C000C948C0030.:10002000...
```

## Пример использования

```bash
# Перемещаем скрипт в папку с прошивкой
# Например: A:\Development\ROBBO\Firmwares\devices_firmware\Robbo_robot_firmware\

# Переходим в директорию с прошивкой
cd A:\Development\ROBBO\Firmwares\devices_firmware\Robbo_robot_firmware

# Запускаем конвертацию
node convert_hex.js

# Используется файл: A:\Development\ROBBO\Firmwares\devices_firmware\Robbo_robot_firmware\Robbo_robot_firmware.hex
# Длина результата: 34863
# Первые 500 символов:
# :100000000C9464000C94720C0C944B0C0C948C00AB...
# 
# Последние 500 символов:
# ...0C317600512C3136000D0A002D2D2D00CB
# 
# Результат сохранен в: A:\Development\ROBBO\Firmwares\devices_firmware\Robbo_robot_firmware\Robbo_robot_firmware_converted.txt
```

## Интеграция с firmwares.js

После конвертации полученный текст можно использовать для обновления файла `firmwares.js`:

1. Откройте `Robboscratch3_DeviceControlAPI\src\firmwares.js`
2. Найдите нужный `device_id_X`
3. Замените содержимое `max_version` на конвертированный текст

### Пример структуры в firmwares.js:

```javascript
const firmwares = {
  device_id_0: {
    max_version: `:100000000C9464000C94720C0C944B0C0C948C00AB.:10001000...`,
  },
  // ...
};
```

## Примечания

- Скрипт сохраняет все HEX-строки, включая маркер конца файла `:00000001FF` (контрольная сумма)
- Все строки объединяются через точку (`.`), что соответствует формату в `firmwares.js`
- Скрипт сохраняет только валидные HEX-строки (начинающиеся с `:`)

## Структура файлов

После перемещения скрипта в папку с прошивкой структура должна выглядеть так:

```
devices_firmware/
└── Robbo_robot_firmware/
    ├── convert_hex.js              # Скрипт конвертации (переместите сюда)
    ├── Robbo_robot_firmware.hex    # Исходный HEX-файл прошивки (любое имя с расширением .hex)
    └── Robbo_robot_firmware_converted.txt  # Результат конвертации (создается автоматически)
```

**Примечание:** Если в папке несколько `.hex` файлов, скрипт использует первый найденный и выведет предупреждение.

